# 2.2.2 PDU
네트워크의 어떠한 계층에서 계층으로 데이터가 전달될 때 한 덩어리의 단위를 PDU(Protocol Data Unit)라고 합니다.

PDU는 제어 관련 정보들이 포함된 ‘헤더’, 데이터를 의미하는 ‘페이로드’로 구성되어 있으며 계층마다 부르는 명칭이 다릅니다. 

- **애플리케이션 계층** : 메시지
- **전송 계층** : 세그먼트(TCP), 데이터그램(UDP)
- **인터넷 계층** : 패킷
- **링크 계층** : 프레임(데이터 링크 계층), 비트(물리 계층)

예를 들어 애플리케이션 층은 ‘메시지’를 기반으로 데이터를 전달하는데, HTTP의 헤더가 문자열인 것을 예로 들 수 있습니다.

잠시 `curl` 명령어를 이용하여 `www.naver.com`으로 HTTP 요청을 해서 PDU 테스팅을 해보겠습니다.

참고로 다음 사이트를 통해 쉽게 curl 명령어로 다른 사이트에 요청할 수 있습니다.

- `curl commands` 온라인 사이트 링크 : https://reqbin.com/curl

![그림 2-34](./images/그림_2-34.png)

앞의 그림처럼 `curl [www.naver.com](http://www.naver.com)` 이란 명령어를 통해 요청했고 다음과 같은 응답(response) 헤더 값이 나오는데, 이는 모두 문자열인 것을 알 수 있습니다.

```sql
// 출력
Server: NWS
Content-Type: text/html; charset=UTF-8
Cache-Control: no-cache, no-store, must-revalidate
Pragma: no-cache
P3P: CP="CAO DSP CURA ADMa TAIa PSAa OUR LAW STP PHY ONL UNI PUR FIN COM
NAV INT DEM STA PRE"
X-Frame-Options: DENY
X-XSS-Protection: 1; mode=block
Strict-Transport-Security: max-age=63072000; includeSubdomains
Referrer-Policy: unsafe-url
Content-Encoding: gzip
Content-Length: 59601
Date: Wed, 26 Jan 2022 05:14:10 GMT
Connection: keep-alive
Vary: Accept-Encoding
```

참고로 PDU 중 아래 계층인 비트로 송수신하는 것이 모든 PDU 중 가장 빠르고 효율성 이 높습니다. 하지만 애플리케이션 계층에서는 문자열을 기반으로 송수신을 하는데, 그 이유는 헤더에 authorization 값 등 다른 값들을 넣는 확장이 쉽기 때문입니다.

## 추가로 알면 좋은 내용

### ✅ PDU는 왜 중요할까?

PDU(Protocol Data Unit)는 단순한 데이터 묶음이 아니라, **네트워크의 각 계층에서 통신을 위해 필요한 정보를 담은 단위**입니다.

각 계층은 자신이 담당하는 역할에 따라 데이터를 포장(캡슐화)하고, 이를 기반으로 상대방과 통신합니다.

따라서 PDU 구조를 이해하면 네트워크 동작 흐름을 명확히 파악할 수 있고, 실제로도 **트래픽 분석, 보안 진단, 성능 최적화** 등에 필수적인 개념입니다.

---

### ✅ 캡슐화(Encapsulation)와 디캡슐화(Decapsulation)

- **캡슐화**: 데이터를 보내는 측에서, 상위 계층의 데이터를 하위 계층으로 내려보낼 때마다 각 계층에 필요한 헤더를 추가하는 과정입니다.
- **디캡슐화**: 데이터를 받는 측에서, 하위 계층부터 상위 계층으로 올라가며 헤더를 하나씩 제거하고 원래의 데이터(페이로드)를 꺼내는 과정입니다.

예시:

사용자의 메시지 → TCP 세그먼트 → IP 패킷 → 프레임 → 비트로 변환되어 전송

→ 다시 수신 측에서 거꾸로 해석

---

### ✅ 계층별 PDU 명칭과 기능 요약

| 계층 | PDU 명칭 | 주요 헤더 정보 |
| --- | --- | --- |
| 애플리케이션 | 메시지 | HTTP 메서드, 상태코드 등 |
| 전송 | 세그먼트(TCP) / 데이터그램(UDP) | 포트번호, 순서 번호, 오류 제어 |
| 인터넷 | 패킷 | 출발지/목적지 IP 주소, TTL |
| 데이터 링크 | 프레임 | MAC 주소, 오류 검출 (FCS) |
| 물리 | 비트 | 전기/광 신호 등 실제 전송 |

---

### ✅ 애플리케이션 계층은 왜 문자열을 사용하나?

애플리케이션 계층의 메시지는 사람이 읽기 쉬운 **문자열 기반 포맷(예: HTTP 헤더)** 을 사용하는 경우가 많습니다.

그 이유는 다음과 같습니다:

- 확장성이 높다 (예: 인증, 쿠키, 사용자 에이전트 등 다양한 헤더를 쉽게 추가 가능)
- 디버깅이 쉬움 (curl 등으로 직접 메시지를 확인 가능)
- 개발자 친화적 (문자열 기반 로그 확인, 테스트 등)

---

### ✅ 실무와의 연결: curl 명령어는 PDU 학습의 좋은 예

curl을 통해 서버와 통신할 때 우리는 애플리케이션 계층에서 메시지를 주고받는 것입니다.

이 메시지는 하위 계층을 거쳐 캡슐화되어 전송되며, 실제로는 프레임과 비트 단위로 네트워크를 통해 전송됩니다.

**이 과정을 이해하면 패킷 분석 도구(Wireshark)나 네트워크 디버깅 도구 사용 시 큰 도움이 됩니다.**

---

### ✅ 보안과 성능 측면에서의 PDU

- 보안: PDU의 헤더에는 인증, 접근 제어, 암호화 여부 등의 정보가 들어갈 수 있어 **보안 정책 설정에 핵심적**입니다.
- 성능: 계층이 많아질수록 헤더도 많아지고 데이터 크기가 커지므로 **속도 저하**가 생길 수 있습니다.
    
    따라서 성능 최적화를 위해서는 PDU 설계도 고려 대상입니다.